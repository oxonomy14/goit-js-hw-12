{"version":3,"file":"index.js","sources":["../src/js/refs.js","../src/js/render-functions.js","../src/js/loader.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const refs = {\n  form: document.querySelector('#search-form'),\n  searchText: document.querySelector('.search-form-input'),\n  btnSearch: document.querySelector('.search-btn'),\n  imageList: document.querySelector('.image-search-list'),\n  btnLoadMore: document.querySelector('.btn-loadmore'),\n  btnLoaderBox: document.querySelector('.btn-loader-box'),\n  txtLoaderMore: document.querySelector('.btn-loader-box-txt'),\n};\n","import { refs } from './refs';\n//import { galleryBox } from '../main';\n\n// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport function renderSearchImages(images) {\n  const markup = images\n    .map(image => {\n      return `<li class=\"image-search-item\" id=\"gallery-item\">\n              <div class=\"image-search-box\">\n               <a \n                href=\"${image.largeImageURL}\">\n                <img\n                  class=\"image-search-img\"\n                  src=\"${image.webformatURL}\"\n                  alt=\"${image.tags}\"\n                  title=\"${image.tags}\"\n                />\n                </a>\n                <div class=\"image-search-descr\">\n                  <ul class=\"image-search-descr-list\">\n                    <li class=\"image-search-descr-item\">\n                      <h3 class=\"image-search-descr-subtitle\">Likes</h3>\n                      <p class=\"image-search-descr-txt\">${image.likes}</p>\n                    </li>\n                    <li class=\"image-search-descr-item\">\n                      <h3 class=\"image-search-descr-subtitle\">Views</h3>\n                      <p class=\"image-search-descr-txt\">${image.views}</p>\n                    </li>\n                    <li class=\"image-search-descr-item\">\n                      <h3 class=\"image-search-descr-subtitle\">Comments</h3>\n                      <p class=\"image-search-descr-txt\">${image.comments}</p>\n                    </li>\n                    <li class=\"image-search-descr-item\">\n                      <h3 class=\"image-search-descr-subtitle\">Downloads</h3>\n                      <p class=\"image-search-descr-txt\">${image.downloads}</p>\n                    </li>\n                  </ul>\n                </div>\n              </div>\n            </li>`;\n    })\n    .join('');\n\n  refs.imageList.insertAdjacentHTML('beforeend', markup);\n\n  // Ініціалізація бібліотеки SimpleLightbox\n  let galleryBox = new SimpleLightbox('.image-search-list a', {\n    captionsData: 'alt', // Витягує підписи із атрибута alt\n    captionDelay: 250, // Затримка появи підпису (в мс)\n  });\n\n  // Оновлення SimpleLightbox, для перезавантаження списку елементів\n  galleryBox.refresh();\n}\n","// Функкції показу/ховання лоадера\nexport function showLoader() {\n  document.querySelector('#image-search').classList.add('hidden'); // Ховаємо контент\n  document.querySelector('.loader-container').style.display = 'flex'; // Показуєм лоадер\n}\n\nexport function hideLoader() {\n  document.querySelector('#image-search').classList.remove('hidden'); // Показуєм контент\n  document.querySelector('.loader-container').style.display = 'none'; // Ховаємо лоадер\n}\n","// Your API key: 48017224-d7e819cca6d5953c75e1fff02\nimport { refs } from './refs';\nimport axios from 'axios';\nimport { renderSearchImages } from './render-functions';\nimport { showLoader, hideLoader } from './loader'; // Импорт функций лоадера\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport async function queryPixabay(query, page, perPage) {\n  const API_KEY = '48017224-d7e819cca6d5953c75e1fff02';\n\n  axios.defaults.baseURL = 'https://pixabay.com';\n\n  const searchParams = new URLSearchParams({\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: perPage,\n    page,\n  });\n\n  // showLoader(); // перед завантаженням даних з API-сервера показуємо лоадер\n  try {\n    const serverResponse = await axios.get(\n      `/api/?key=${API_KEY}&${searchParams}`\n    );\n\n    const totalImages = serverResponse.data.total;\n    // console.log('Всього зображень:', totalImages);\n\n    const totalPages = Math.ceil(totalImages / perPage);\n    // console.log('Всього колекцій:', totalPages);\n\n    if (Number.parseInt(serverResponse.data.total) > 0) {\n      const images = serverResponse.data.hits;\n      //console.log(images);\n      //console.log(images[0].webformatURL);\n      //console.log('Отримані зображення:', images);\n      renderSearchImages(images); //створюємо розмітку і прорисовуємо на веб-сторінці\n      // console.log('Колекція за номером:', page);\n      //refs.btnLoadMore.style.display = page < totalPages ? 'block' : 'none';\n      if (page < totalPages) {\n        refs.btnLoadMore.style.display = 'block';\n        //console.log('Колекція за номером:', page);\n      } else {\n        refs.btnLoadMore.style.display = 'none';\n        //  console.log('Зображень більше немає');\n        iziToast.error({\n          title: 'Images no have any more',\n          message: `❌ We're sorry, but you've reached the end of search results.`,\n          position: 'topCenter',\n          timeout: 5000,\n        });\n        return;\n      }\n    } else {\n      iziToast.error({\n        title: 'Помилка',\n        message: `❌ Sorry, there are no images matching your search query. Please try again!`,\n        position: 'topCenter',\n        timeout: 5000,\n      });\n      return;\n    }\n  } catch (error) {\n    error =>\n      iziToast.error({\n        title: 'Помилка',\n        message: `❌ Виникла помилка завантаження на стороні сервера Pixabay. Спробуйте іншим разом!`,\n        position: 'topCenter',\n        timeout: 5000,\n      });\n  } finally {\n    hideLoader(); // Ховаємо лоадер в будь-якому випадку  (успіх або помилка)\n  }\n}\n","import { queryPixabay } from './js/pixabay-api';\nimport { refs } from './js/refs';\n\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet query = ''; // Змінна для збереження пошукового запиту\nlet page = 1; // Починаємо з першої сторінки\nconst perPage = 40; // Кількість зображень на сторінку\n\nrefs.btnLoadMore.style.display = 'none'; // Сховати кнопку перед запитом\nrefs.txtLoaderMore.style.display = 'none'; // Показати індикатор завантаження\n\nrefs.form.addEventListener('submit', onFormSubmit);\nrefs.btnLoadMore.addEventListener('click', onBtnClick);\n\nfunction onFormSubmit(evt) {\n  evt.preventDefault();\n\n  //console.log('Лог№1 - Кнопка \"Пошук\" натискається');\n\n  refs.imageList.innerHTML = ''; // Перед пошуком за новим ключовим словом повністю очищаємо попередній вміст галереї\n  page = 1; // Скидаємо номер сторінки\n  query = evt.currentTarget.elements.query.value.trim();\n\n  if (!query) {\n    iziToast.error({\n      title: 'Помилка',\n      message: `❌ Введіть в поле пошуку пошукову фразу`,\n      position: 'topCenter',\n      timeout: 2500,\n    });\n    //window.alert('Введіть в поле пошуку пошукову фразу');\n    // console.log('Введіть в поле пошуку пошукову фразу');\n    return;\n  } else {\n    // console.log('Пошуковий запит:', query);\n\n    try {\n      queryPixabay(query, page, perPage);\n      // renderSearchImages(images); // запит до сервера Pixabay за пошуковою фразою\n    } catch (error) {\n      console.log(error);\n    } finally {\n      //toggleLoadMore(true); // Сховати індикатор завантаження\n      refs.txtLoaderMore.style.display = 'none';\n    }\n  }\n  refs.form.reset();\n}\n\n// -----------  Натискання кнопки Load More  -------------------\n\n// ---- Завантаження наступної сторінки ----\nasync function onBtnClick() {\n  page += 1; // Збільшуємо сторінку\n\n  try {\n    refs.btnLoadMore.style.display = 'none';\n    refs.txtLoaderMore.style.display = 'block';\n\n    //console.log('Перед запитом:', refs.txtLoaderMore.style.display); // Дебаг\n    await queryPixabay(query, page, perPage);\n    //console.log('Після запиту:', refs.txtLoaderMore.style.display); // Дебаг\n\n    smoothScroll(); // Скрол після рендеру\n  } catch (error) {\n    console.error(error);\n  } finally {\n    refs.txtLoaderMore.style.display = 'none';\n    refs.btnLoadMore.style.display = 'block';\n  }\n}\n\nfunction smoothScroll() {\n  setTimeout(() => {\n    if (!refs.imageList) return;\n\n    const galleryItem = document.querySelectorAll('.image-search-list li'); // Всі елементи галереї\n    if (galleryItem.length === 0) {\n      // console.log('Галерея порожня або ще не завантажилася');\n      return;\n    }\n    //console.log('Елемент', galleryItem[0]);\n    const cardHeight = galleryItem[0].getBoundingClientRect().height; // Висота першого елемента\n    // console.log('Висота', cardHeight);\n    window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' }); // Прокручуємо\n  }, 500); // Чекаємо 500 мс, щоб DOM оновився\n}\n"],"names":["refs","renderSearchImages","images","markup","image","SimpleLightbox","hideLoader","queryPixabay","query","page","perPage","API_KEY","axios","searchParams","serverResponse","totalImages","totalPages","iziToast","onFormSubmit","onBtnClick","evt","error","smoothScroll","galleryItem","cardHeight"],"mappings":"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"}